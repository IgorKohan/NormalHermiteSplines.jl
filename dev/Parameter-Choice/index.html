<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Selecting a good value of the scaling parameter · NormalHermiteSplines.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">NormalHermiteSplines.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Public-API/">Public API</a></li><li><a class="tocitem" href="../Usage/">Example Usage</a></li><li class="is-active"><a class="tocitem" href>Selecting a good value of the scaling parameter</a></li><li><a class="tocitem" href="../Numerical-Tests/">Numerical Tests</a></li><li><a class="tocitem" href="../Normal-Splines-Method/">Normal Splines Method</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Selecting a good value of the scaling parameter</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Selecting a good value of the scaling parameter</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/IgorKohan/NormalHermiteSplines.jl/blob/master/docs/src/Parameter-Choice.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Selecting-a-good-value-of-the-scaling-parameter"><a class="docs-heading-anchor" href="#Selecting-a-good-value-of-the-scaling-parameter">Selecting a good value of the scaling parameter</a><a id="Selecting-a-good-value-of-the-scaling-parameter-1"></a><a class="docs-heading-anchor-permalink" href="#Selecting-a-good-value-of-the-scaling-parameter" title="Permalink"></a></h1><p>Approximating properties of the normal spline are getting better with the smaller value of the scaling (&#39;shape&#39;) parameter <span>$\varepsilon$</span>. In a case when value of this parameter is small enough the normal spline become similar to Duchon&#39;s <span>$D^m-spline$</span> [2]. Details are described in <a href="https://igorkohan.github.io/NormalHermiteSplines.jl/stable/Relation-to-Polyharmonic-Splines/">Comparison with Polyharmonic Splines</a>.</p><p>However with decreasing value of the parameter <span>$\varepsilon$</span> the condition number of the corresponding problem Gram matrix is increasing and the problem becomes numerically unstable (see &quot;uncertainty principle&quot; of Schaback [4]). The Gram matrix of the interpolating problem even can lost its positive definiteness property if <span>$\varepsilon$</span> is small. Also, as it was pointed out in [3] the RBF interpolation with small value of the &quot;shape&quot; parameter may cause the Runge phenomenon i.e. undesirable interpolant oscillations which are most likely observed at the domain border. </p><p>Therefore, when choosing the value of the <span>$\varepsilon$</span>, a compromise is needed. In practice, it is necessary to choose such value of the scaling parameter that estimation of the Gram matrix condition number is a relatively small number and the value of interpolation result significant digits estimation is a good enough.  As a rule, the heuristic algorithm implemented within the interpolation procedure produces a good estimation of the scaling parameter value (this algorithm applies if the value of the scaling parameter was not provided explicitly in creation of the reproducing kernel object).</p><p>The following API functions are useful for selecting a suitable value of the scaling parameter</p><ul><li><code>estimate_cond</code></li><li><code>get_epsilon</code></li><li><code>estimate_accuracy</code></li><li><code>estimate_epsilon</code>  </li></ul><p>As example let&#39;s consider interpolation of function <span>$f (x,y)$</span> (function <span>$N7$</span> from [5])</p><div>\[f (x,y) = \frac{2}{3}cos(10x)sin(10y) + \frac{1}{3}sin(10xy)\]</div><img src="../images/parameter-choice/p-cf.png" width="256"/><img src="../images/parameter-choice/p-grid.png" width="197"/><p>sampled on set <span>$\Chi$</span> of 100 pseudo-random nodes uniformly distributed on unit square <span>$\Omega = [0,1]^2$</span>.</p><pre><code class="language-none">    using NormalHermiteSplines
    ....
    spline = interpolate(nodes, u, rk)
    ε = get_epsilon(spline)
    κ_1 = estimate_cond(spline)
    significant_digits = estimate_accuracy(spline)
    σ = evaluate(spline, grid)
    ....</code></pre><p>the complete example code can be found in <a href="https://igorkohan.github.io/NormalHermiteSplines.jl/stable/Usage/#D-interpolation-case-2/">Example usage</a>.</p><p>The normal splines <span>$\sigma (x,y)$</span> are evaluated on a regular grid <span>$E_S= \{(x_i, y_i)\, , \ i=1, \dots, S \}$</span> of <span>$S = 101 × 101$</span> points. The interpolation error is measured by means of the Root Mean Square Error (<span>$RMSE$</span>)</p><div>\[  RMSE = \sqrt { \frac{1}{S} \sum_{i=1}^S |f (x_i,y_i) - \sigma (x_i,y_i) |^2 } \ ,\]</div><p>and the Maximum Absolute Arror (<span>$MAE$</span>)</p><div>\[  MAE = \max_{1 \le i \le S} |f (x_i,y_i) - \sigma (x_i,y_i) | \ .\]</div><p>Estimation of the number of the interpolant &#39;significant digits&#39; (<span>$SD$</span>) is calculated as</p><div>\[SD = -[\log_{10}(\max_{(x_k, y_k) \in \Chi} |f (x_k,y_k) - \sigma (x_k,y_k) |)] - 1 \ ,\]</div><p>here <span>$(x_k, y_k) \in \Chi$</span> are interplation nodes and <span>$[\cdot]$</span> denotes an integer part of number.</p><p>Estimation of the 1-norm condition number <span>$\kappa_1$</span> of the interpolation problem Gram matrix is obtained by function <code>estimate_cond</code> that implements the procedure described in [1]. It requires <span>$O(N^2)$</span> operations.</p><p>The results of this function interpolation with reproducing kernel <code>RK_H0</code> are displayed in Table I, results of interpolation with reproducing kernel <code>RK_H1</code> are displayed in Table II and results of interpolation received with reproducing kernel <code>RK_H2</code> – in Table III. The first row of each table corresponds to results obtained with automatically selected value of the scaling parameter <span>$\varepsilon$</span>. </p><p>Notice that a two-dimensional normal spline built with <code>RK_H0</code> reproducing kernel is an element of the Bessel potential space <span>$H^{3/2}_\varepsilon (R^2)$</span>, an element of that space can be treated as a bounded continuous function. Correspondingly, a two-dimensional normal spline built with <code>RK_H1</code> reproducing kernel is an element of the Bessel potential space <span>$H^{5/2}_\varepsilon (R^2)$</span>, an element of that space can be treated as a bounded with its derivatives continuously differentiable function. Further, a two-dimensional normal spline built with <code>RK_H2</code> reproducing kernel is an element of the Bessel potential space <span>$H^{7/2}_\varepsilon (R^2)$</span>, an element of that space can be treated as a bounded with all its derivatives twice continuously differentiable function.  </p><p>Table I: Spline constructed with <code>RK_H0</code> reproducing kernel</p><table><tr><th style="text-align: center">ε</th><th style="text-align: center"><span>$\kappa_1$</span></th><th style="text-align: center">SD</th><th style="text-align: center">RMSE</th><th style="text-align: center">MAE</th></tr><tr><td style="text-align: center"><strong>1.7e+00</strong></td><td style="text-align: center"><strong>1.0e+05</strong></td><td style="text-align: center"><strong>14</strong></td><td style="text-align: center"><strong>9.2e-02</strong></td><td style="text-align: center"><strong>6.3e-01</strong></td></tr><tr><td style="text-align: center">1.0e+01</td><td style="text-align: center">1.0e+03</td><td style="text-align: center">15</td><td style="text-align: center">1.1e-01</td><td style="text-align: center">4.7e-01</td></tr><tr><td style="text-align: center">1.0e+00</td><td style="text-align: center">1.0e+05</td><td style="text-align: center">14</td><td style="text-align: center">9.2e-02</td><td style="text-align: center">6.5e-01</td></tr><tr><td style="text-align: center">1.0e-01</td><td style="text-align: center">1.0e+07</td><td style="text-align: center">13</td><td style="text-align: center">9.3e-02</td><td style="text-align: center">6.8e-01</td></tr><tr><td style="text-align: center">1.0e-02</td><td style="text-align: center">1.0e+08</td><td style="text-align: center">12</td><td style="text-align: center">9.3e-02</td><td style="text-align: center">6.9e-01</td></tr><tr><td style="text-align: center">1.0e-03</td><td style="text-align: center">1.0e+09</td><td style="text-align: center">10</td><td style="text-align: center">9.3e-02</td><td style="text-align: center">6.9e-01</td></tr><tr><td style="text-align: center">1.0e-04</td><td style="text-align: center">1.0e+10</td><td style="text-align: center">9</td><td style="text-align: center">9.3e-02</td><td style="text-align: center">6.9e-01</td></tr><tr><td style="text-align: center">1.0e-05</td><td style="text-align: center">1.0e+11</td><td style="text-align: center">8</td><td style="text-align: center">9.3e-02</td><td style="text-align: center">6.9e-01</td></tr><tr><td style="text-align: center">1.0e-06</td><td style="text-align: center">1.0e+12</td><td style="text-align: center">8</td><td style="text-align: center">9.3e-02</td><td style="text-align: center">6.9e-01</td></tr><tr><td style="text-align: center">1.0e-07</td><td style="text-align: center">1.0e+13</td><td style="text-align: center">6</td><td style="text-align: center">9.3e-02</td><td style="text-align: center">6.9e-01</td></tr><tr><td style="text-align: center">1.0e-08</td><td style="text-align: center">1.0e+14</td><td style="text-align: center">5</td><td style="text-align: center">9.3e-02</td><td style="text-align: center">6.9e-01</td></tr><tr><td style="text-align: center">1.0e-09</td><td style="text-align: center">1.0e+15</td><td style="text-align: center">5</td><td style="text-align: center">9.3e-02</td><td style="text-align: center">6.9e-01</td></tr><tr><td style="text-align: center">1.0e-10</td><td style="text-align: center">1.0e+16</td><td style="text-align: center">4</td><td style="text-align: center">9.3e-02</td><td style="text-align: center">6.9e-01</td></tr><tr><td style="text-align: center">1.0e-11</td><td style="text-align: center">1.0e+17</td><td style="text-align: center">3</td><td style="text-align: center">9.3e-02</td><td style="text-align: center">6.9e-01</td></tr><tr><td style="text-align: center">1.0e-12</td><td style="text-align: center">1.0e+18</td><td style="text-align: center">2</td><td style="text-align: center">9.3e-02</td><td style="text-align: center">6.9e-01</td></tr><tr><td style="text-align: center">1.0e-13</td><td style="text-align: center">1.0e+19</td><td style="text-align: center">1</td><td style="text-align: center">9.6e-02</td><td style="text-align: center">7.1e-01</td></tr><tr><td style="text-align: center">1.0e-14</td><td style="text-align: center">—</td><td style="text-align: center">—</td><td style="text-align: center">—</td><td style="text-align: center">—</td></tr></table><p>These plots show normal splines constructed with <code>RK_H0()</code> (<span>$\varepsilon = 1.7$</span>), <code>RK_H0(1.0e-12)</code> and <code>RK_H0(1.0e-13)</code> reproducing kernels</p><img src="../images/parameter-choice/p-cs,0.0,-.png" width="256"/><img src="../images/parameter-choice/p-cs,1.0e-12,-.png" width="256"/><img src="../images/parameter-choice/p-cs,1.0e-13,-.png" width="256"/><p>Table II: Spline constructed with <code>RK_H1</code> reproducing kernel</p><table><tr><th style="text-align: center">ε</th><th style="text-align: center"><span>$\kappa_1$</span></th><th style="text-align: center">SD</th><th style="text-align: center">RMSE</th><th style="text-align: center">MAE</th></tr><tr><td style="text-align: center"><strong>2.6e+00</strong></td><td style="text-align: center"><strong>1.0e+08</strong></td><td style="text-align: center"><strong>13</strong></td><td style="text-align: center"><strong>4.5e-02</strong></td><td style="text-align: center"><strong>4.1e-01</strong></td></tr><tr><td style="text-align: center">1.0e+01</td><td style="text-align: center">1.0e+06</td><td style="text-align: center">14</td><td style="text-align: center">5.4e-02</td><td style="text-align: center">4.7e-01</td></tr><tr><td style="text-align: center">1.0e+00</td><td style="text-align: center">1.0e+09</td><td style="text-align: center">11</td><td style="text-align: center">4.4e-02</td><td style="text-align: center">3.7e-01</td></tr><tr><td style="text-align: center">1.0e-01</td><td style="text-align: center">1.0e+12</td><td style="text-align: center">8</td><td style="text-align: center">4.4e-02</td><td style="text-align: center">3.7e-01</td></tr><tr><td style="text-align: center">1.0e-02</td><td style="text-align: center">1.0e+15</td><td style="text-align: center">5</td><td style="text-align: center">4.4e-02</td><td style="text-align: center">3.7e-01</td></tr><tr><td style="text-align: center">1.0e-03</td><td style="text-align: center">1.0e+19</td><td style="text-align: center">2</td><td style="text-align: center">4.4e-02</td><td style="text-align: center">3.6e-01</td></tr><tr><td style="text-align: center">1.0e-04</td><td style="text-align: center">—</td><td style="text-align: center">—</td><td style="text-align: center">—</td><td style="text-align: center">—</td></tr></table><p>Table III: Spline constructed with <code>RK_H2</code> reproducing kernel</p><table><tr><th style="text-align: center">ε</th><th style="text-align: center"><span>$\kappa_1$</span></th><th style="text-align: center">SD</th><th style="text-align: center">RMSE</th><th style="text-align: center">MAE</th></tr><tr><td style="text-align: center"><strong>3.5e+00</strong></td><td style="text-align: center"><strong>1.0e+10</strong></td><td style="text-align: center"><strong>12</strong></td><td style="text-align: center"><strong>2.2e-02</strong></td><td style="text-align: center"><strong>1.8e-01</strong></td></tr><tr><td style="text-align: center">1.0e+01</td><td style="text-align: center">1.0e+07</td><td style="text-align: center">13</td><td style="text-align: center">3.4e-02</td><td style="text-align: center">3.2e-01</td></tr><tr><td style="text-align: center">1.0e+00</td><td style="text-align: center">1.0e+13</td><td style="text-align: center">9</td><td style="text-align: center">2.3e-02</td><td style="text-align: center">2.7e-01</td></tr><tr><td style="text-align: center">1.0e-01</td><td style="text-align: center">1.0e+18</td><td style="text-align: center">4</td><td style="text-align: center">2.5e-02</td><td style="text-align: center">3.4e-01</td></tr><tr><td style="text-align: center">1.0e-02</td><td style="text-align: center">—</td><td style="text-align: center">—</td><td style="text-align: center">—</td><td style="text-align: center">—</td></tr></table><p>For comparison, in Table III-D we presented the results of interpolation received by using extended precision arithmetic (extended precision <span>$Double64$</span> float type from the <a href="https://github.com/JuliaMath/DoubleFloats.jl">DoubleFloats.jl</a> package has 31 significant decimal digits).  </p><p>Table III-D: Spline constructed with <code>RK_H2</code> reproducing kernel using extended Double64 arithmetic</p><table><tr><th style="text-align: center">ε</th><th style="text-align: center"><span>$\kappa_1$</span></th><th style="text-align: center">SD</th><th style="text-align: center">RMSE</th><th style="text-align: center">MAE</th></tr><tr><td style="text-align: center"><strong>3.5e+00</strong></td><td style="text-align: center"><strong>1.0e+10</strong></td><td style="text-align: center"><strong>28</strong></td><td style="text-align: center"><strong>2.2e-02</strong></td><td style="text-align: center"><strong>1.8e-01</strong></td></tr><tr><td style="text-align: center">1.0e+01</td><td style="text-align: center">1.0e+07</td><td style="text-align: center">29</td><td style="text-align: center">3.4e-02</td><td style="text-align: center">3.2e-01</td></tr><tr><td style="text-align: center">1.0e+00</td><td style="text-align: center">1.0e+13</td><td style="text-align: center">25</td><td style="text-align: center">2.3e-02</td><td style="text-align: center">2.7e-01</td></tr><tr><td style="text-align: center">1.0e-01</td><td style="text-align: center">1.0e+18</td><td style="text-align: center">20</td><td style="text-align: center">2.5e-02</td><td style="text-align: center">3.4e-01</td></tr><tr><td style="text-align: center">1.0e-02</td><td style="text-align: center">1.0e+23</td><td style="text-align: center">15</td><td style="text-align: center">2.5e-02</td><td style="text-align: center">3.4e-01</td></tr><tr><td style="text-align: center">1.0e-03</td><td style="text-align: center">1.0e+28</td><td style="text-align: center">10</td><td style="text-align: center">2.5e-02</td><td style="text-align: center">3.4e-01</td></tr><tr><td style="text-align: center">1.0e-04</td><td style="text-align: center">1.0e+33</td><td style="text-align: center">5</td><td style="text-align: center">2.5e-02</td><td style="text-align: center">3.4e-01</td></tr><tr><td style="text-align: center">1.0e-05</td><td style="text-align: center">—</td><td style="text-align: center">—</td><td style="text-align: center">—</td><td style="text-align: center">—</td></tr></table><p>As can be seen from these tables, for small values of the scaling parameter <span>$\varepsilon$</span> interpolation results have the similar quality, and it make sense to chose such <span>$\varepsilon$</span> value that provides &quot;good&quot; values of the result significant digits estimation (at least 7 – 10 digits in most cases) and reasonable estimation of the problem Gram matrix condition number.</p><p><strong>References</strong></p><p>[1] C. Brás, W. Hager, J. Júdice, An investigation of feasible descent algorithms for estimating the condition number of a matrix. TOP 20, 2012.</p><p>[2] J. Duchon, Splines minimizing rotation-invariant semi-norms in Sobolev spaces, Lect. Notes in Math., Springer, Berlin, Vol. 571, 1977.</p><p>[3] B. Fornberg, J. Zuev, The Runge phenomenon and spatially variable shape parameters in RBF interpolation, Comput. Math. Appl., Vol.54, No.3, 2007.</p><p>[4] R. Schaback, Error estimates and condition numbers for radial basis functions interpolation, Adv. in Comput. Math. 3, 1995.</p><p>[5] R. Renka, R. Brown, Algorithm 792: accuracy test of ACM algorithms for interpolation of scattered data in the plane, ACM Transactions on Mathematical Software (TOMS), Vol.25, No.1, 1999.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Usage/">« Example Usage</a><a class="docs-footer-nextpage" href="../Numerical-Tests/">Numerical Tests »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 9 April 2021 17:48">Friday 9 April 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
